# 桑基图 (Sankey Diagram)

## 📊 图表简介

桑基图是一种特殊的**流量图**，用**带宽度的曲线**连接各节点，曲线宽度与流量大小成正比，主要用于展示能量、物质、资金等在系统中的流动和转换。

## 🎯 适用场景

| 场景               | 说明                               |
| ------------------ | ---------------------------------- |
| **能源流向** | 能源从生产到消费的流动（经典应用） |
| **资金流向** | 收入来源和支出去向                 |
| **用户路径** | 网站/APP用户的行为流程             |
| **物质流动** | 供应链、生产流程中的物料流向       |
| **转换分析** | 用户转化漏斗、状态转换             |

## 📈 图表分类

### 1. 两层桑基图

- 源节点 → 目标节点
- 最简单的流量展示

### 2. 多层桑基图

- 多个阶段的流量传递
- 展示完整的流程链

### 3. 循环桑基图

- 允许节点之间的双向流动
- 展示更复杂的系统关系

## ⚖️ 与相似图表的对比

| 对比图表         | 桑基图优势                   | 桑基图劣势               |
| ---------------- | ---------------------------- | ------------------------ |
| **冲击图** | 流量宽度更直观，强调量的传递 | 不适合多时间点的状态追踪 |
| **和弦图** | 适合单向/层次流动            | 不适合循环对称关系       |
| **网络图** | 强调流量大小                 | 不适合展示网络拓扑       |
| **漏斗图** | 展示分支和多路径             | 不适合单一线性转化       |

## 🔄 桑基图 vs 冲击图

### 桑基图特点

- 强调**流量大小**（带宽代表流量）
- 适合**系统流动**分析
- 节点可以合并和分流

### 冲击图特点

- 强调**状态转换**（追踪每个个体的路径）
- 适合**时间序列**状态变化
- 保持个体的可追踪性

## 🤔 如何选择

```
展示目的？
├── 能量/物质/资金流动 → 桑基图
├── 个体状态随时间变化 → 冲击图
├── 循环关系/对称关系 → 和弦图
└── 单一转化漏斗 → 漏斗图

数据特征？
├── 有明确的源和目标 → 桑基图
├── 多阶段流程 → 多层桑基图
└── 双向流动 → 循环桑基图或和弦图

关注点？
├── 流量大小 → 桑基图
├── 转化率 → 漏斗图
└── 个体路径 → 冲击图
```

## 💡 使用建议

1. **节点排列**：源节点在左，目标节点在右（或上下布局）
2. **颜色策略**：
   - 按源节点着色：追踪来源
   - 按目标节点着色：关注去向
   - 渐变色：强调流动过程
3. **流量排序**：大流量放在上方，便于阅读
4. **节点间距**：保持适当间距，避免拥挤
5. **标签位置**：节点标签放在节点旁，流量值可标在曲线上
6. **流量守恒**：注意检查流入=流出（除非有消耗/产生）
7. **简化展示**：小流量可合并为"其他"类别

## 📐 解读要点

| 图形特征     | 含义               |
| ------------ | ------------------ |
| 曲线越宽     | 流量越大           |
| 多条曲线汇聚 | 多个来源合并       |
| 单条曲线分叉 | 流量分流到多个目标 |
| 节点高度     | 该节点的总流量     |
| 颜色渐变     | 流量的来源或去向   |

## ⚠️ 注意事项

1. **节点数量**：过多节点会使图表混乱（建议每层≤10个）
2. **流量比例**：确保宽度与流量成正比
3. **避免交叉**：尽量减少曲线交叉，可通过节点排序优化
4. **数据完整性**：所有流量都应有明确的来源和去向
